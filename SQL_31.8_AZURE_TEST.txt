CREATE TABLE DEPARTMENT(
DEPTID VARCHAR(50) PRIMARY KEY,
DEPTNAME VARCHAR(50),
DEPTCODE VARCHAR(50)
);

CREATE TABLE EMPLOYEE(
EMPID VARCHAR(50) PRIMARY KEY,
EMPNAME VARCHAR(50),
EMAILID VARCHAR(50),
DEPTID VARCHAR(50),
FOREIGN KEY (DEPTID) REFERENCES DEPARTMENT (DEPTID),
DESIGNATION VARCHAR(50)
);

CREATE TABLE STUDENTS(
SLNO INTEGER PRIMARY KEY,
ID INTEGER,
NAME VARCHAR(50),
SUBJECT VARCHAR(50),
MARKS INTEGER
);

INSERT INTO STUDENTS
VALUES
(1,5030,'ASHLEY','DWH',50),
(2,5031,'PRIYA','DWH',61),
(3,5032,'JULIA','DWH',90),
(4,5033,'DON','DWH',50),
(5,5034,'BOB','DWH',65),
(6,5030,'ASHLEY','SQL',75),
(7,5031,'PRIYA','SQL',80),
(8,5032,'JULIA','SQL',40),
(9,5033,'DON','SQL',88),
(10,5034,'BOB','SQL',92),
(11,5030,'ASHLEY','AZURE',95),
(12,5031,'PRIYA','AZURE',45),
(13,5032,'JULIA','AZURE',85),
(14,5033,'DON','AZURE',57),
(15,5034,'BOB','AZURE',44)

SELECT NAME, SUBJECT, MAX(MARKS) FROM STUDENTS GROUP BY [SUBJECT];

SELECT * FROM STUDENTS ORDER BY [SUBJECT], MARKS DESC;

SELECT * FROM STUDENTS WHERE MARKS < 50;

SELECT * FROM STUDENTS WHERE [SUBJECT]='AZURE' ORDER BY MARKS DESC;

SELECT [NAME], SUM[MARKS] AS TOTALSCORE FROM STUDENTS GROUP BY ID;

SELECT [NAME], SUM[MARKS] AS TOTALSCORE FROM STUDENTS GROUP BY ID Order BY TOTALSCORE;

SELECT [subject], SUM[MARKS] AS totalscore FROM STUDENTS GROUP BY [subject] order by totalscore;

SELECT [subject], SUM[MARKS] AS highest_score FROM STUDENTS GROUP BY [subject];

-------------------------------------------------------------------------------------------------------------------------------------

SELECT DENSE_RANK() OVER [PARTITION BY SUBJECT ORDER BY MARKS DESC) DRN, SUBJECT, MARKS, NAME FROM STUDENTS;
WITH CTE AS(
SELECT DENSE_RANK() OVER [PARTITION BY SUBJECT ORDER BY MARKS DESC) DRN, SUBJECT, MARKS, NAME FROM STUDENTS)
SELECT * FROM CTE WHERE DRN=1;  //DRN=1 FOR HIGHEST VALUE, 2 FOR SECOND HIGHEST AND SO ON

